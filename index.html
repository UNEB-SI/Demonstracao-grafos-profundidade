<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Busca em profundidade</title>
    <link rel="stylesheet" href="app.css">
    <link rel="stylesheet" href="mini-default.min.css">
    <link rel="stylesheet" href="custom.css">
    <link rel="stylesheet" href="./css/font-awesome.min.css">    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    
  </head>
  
  <body>
      <header>
          <a href="#" class="logo">Grafos Profundidade</a>
          <a href="https://github.com/UNEB-SI/Demonstracao-grafos-profundidade" role="button"><i class="fa fa-github-alt" aria-hidden="true"></i></a>
        </header>
        <div class="col-sm row">
            <div class="col-sm-6">
                <div class="card fluid">
                    <div class="section">
                      <h3>Matriz de adjacência</h3>
                      <table class="scrollable" style="max-height: none;" id="tabela">
                          <!--<caption>Matriz de adjacencia</caption>-->
                          <thead>
                            <tr>
                              
                              <th id="hh">N</th>
                              <th id="h0">0</th>
                              <th id="h1">1</th>
                              <th id="h2">2</th>
                              <th id="h3">3</th>
                              <th id="h4">4</th>
                              <th id="h5">5</th>
                              <th id="h6">6</th>
                              <th id="h7">7</th>
                              <th id="h8">8</th>
                              <th id="h9">9</th>
                              
                              
                              
                            </tr>
                          </thead>
                          <tbody>
                            
                              <tr>
                                  <th id="c0">0</th>
                                  <td id="00">0</td>
                                  <td id="01">1</td>
                                  <td id="02">2</td>
                                  <td id="03">3</td>
                                  <td id="04">4</td>
                                  <td id="05">5</td>
                                  <td id="06">6</td>
                                  <td id="07">7</td>
                                  <td id="08">8</td>
                                  <td id="09">9</td>
                                <tr>
                                <tr>
                                  <th id="c1">1</th>
                                  <td id="10">0</td>
                                  <td id="11">1</td>
                                  <td id="12">2</td>
                                  <td id="13">3</td>
                                  <td id="14">4</td>
                                  <td id="15">5</td>
                                  <td id="16">6</td>
                                  <td id="17">7</td>
                                  <td id="18">8</td>
                                  <td id="19">9</td>
                                <tr>
                                <tr>
                                  <th id="c2">2</th>
                                  <td id="20">0</td>
                                  <td id="21">1</td>
                                  <td id="22">2</td>
                                  <td id="23">3</td>
                                  <td id="24">4</td>
                                  <td id="25">5</td>
                                  <td id="26">6</td>
                                  <td id="27">7</td>
                                  <td id="28">8</td>
                                  <td id="29">9</td>
                                <tr>
                                <tr>
                                  <th id="c3">3</th>
                                  <td id="30">0</td>
                                  <td id="31">1</td>
                                  <td id="32">2</td>
                                  <td id="33">3</td>
                                  <td id="34">4</td>
                                  <td id="35">5</td>
                                  <td id="36">6</td>
                                  <td id="37">7</td>
                                  <td id="38">8</td>
                                  <td id="39">9</td>
                                <tr>
                                <tr>
                                  <th id="c4">4</th>
                                  <td id="40">0</td>
                                  <td id="41">1</td>
                                  <td id="42">2</td>
                                  <td id="43">3</td>
                                  <td id="44">4</td>
                                  <td id="45">5</td>
                                  <td id="46">6</td>
                                  <td id="47">7</td>
                                  <td id="48">8</td>
                                  <td id="49">9</td>
                                <tr>
                                <tr>
                                  <th id="c5">5</th>
                                  <td id="50">0</td>
                                  <td id="51">1</td>
                                  <td id="52">2</td>
                                  <td id="53">3</td>
                                  <td id="54">4</td>
                                  <td id="55">5</td>
                                  <td id="56">6</td>
                                  <td id="57">7</td>
                                  <td id="58">8</td>
                                  <td id="59">9</td>
                                <tr>
                                <tr>
                                  <th id="c6">6</th>
                                  <td id="60">0</td>
                                  <td id="61">1</td>
                                  <td id="62">2</td>
                                  <td id="63">3</td>
                                  <td id="64">4</td>
                                  <td id="65">5</td>
                                  <td id="66">6</td>
                                  <td id="67">7</td>
                                  <td id="68">8</td>
                                  <td id="69">9</td>
                                <tr>
                                <tr>
                                  <th id="c7">7</th>
                                  <td id="70">0</td>
                                  <td id="71">1</td>
                                  <td id="72">2</td>
                                  <td id="73">3</td>
                                  <td id="74">4</td>
                                  <td id="75">5</td>
                                  <td id="76">6</td>
                                  <td id="77">7</td>
                                  <td id="78">8</td>
                                  <td id="79">9</td>
                                <tr>
                                <tr>
                                  <th id="c8">8</th>
                                  <td id="80">0</td>
                                  <td id="81">1</td>
                                  <td id="82">2</td>
                                  <td id="83">3</td>
                                  <td id="84">4</td>
                                  <td id="85">5</td>
                                  <td id="86">6</td>
                                  <td id="87">7</td>
                                  <td id="88">8</td>
                                  <td id="89">9</td>
                                <tr>
                                <tr>
                                  <th id="c9">9</th>
                                  <td id="90">0</td>
                                  <td id="91">1</td>
                                  <td id="92">2</td>
                                  <td id="93">3</td>
                                  <td id="94">4</td>
                                  <td id="95">5</td>
                                  <td id="96">6</td>
                                  <td id="97">7</td>
                                  <td id="98">8</td>
                                  <td id="99">9</td>
                                <tr>
                                
  

                          </tbody>
                        </table>
                        <fieldset>
                          <div class="input-group fluid">
                            <label for="nnumero-matrizmbr">Matrix size</label>
                            <input type="number" id="numero-matriz" value="9" min="0" max="9">                          
                            <button onclick="atualizaMatriz();">Update</button>  
                          </div>
                          <div class="input-group fluid">
                            <div class="button-group">
                              <button class=" large" onclick="pause()"><i class="fa fa-pause" aria-hidden="true"></i></button>
                              <button class="inverse large" onclick="play()"><i class="fa fa-play" aria-hidden="true"></i></button>                              
                              <button class="large" onclick="next()"><i class="fa fa-arrow-right" aria-hidden="true"></i></button>
                            </div>
                            
                          </div>
                          <div class="input-group fluid">
                            <!--<button class="inverse large" onclick="restartAll();">Restart all</button>-->
                            <button class="secondary large" onclick="superSnakeEatsAll()">Don't press this button</button>
                          </div>
                        </fieldset>
                    </div>
                  </div>     
            </div>
            <div class="col-sm-6">
                <div class="card fluid">
                    <div class="section">
                      <h3>Visualização</h3>
                      <graph style="margin:auto"></graph>
                    </div>
                  </div>                
            </div>
            
          </div>
  </body>

  <script src="d3.v3.min.js"></script>
  <script src="app.js"></script>
  <script src="jquery-3.2.1.min.js"></script>

  <script>
    /*
    links.push({left:false,right:true,source:nodes[2],target:nodes[0]})
    links.push({left:false,right:true,source:nodes[0],target:nodes[2]})
    restart()
    */

    var controle = {
      i: 0,
      j: -1,
      tam: 10,
      v: [0],
      pre:[0],
      count: 0
    };

    function novoVertice() {
      // prevent I-bar on drag
      //d3.event.preventDefault();

      // because :active only works in WebKit?
      svg.classed('active', true);

      node = {id: ++lastNodeId, reflexive: true};
      node.x = 1;
      node.y = 1;
      console.log(node);
      nodes.push(node);

      restart();
      return node.id;
    }

    function novoVerticeId(id) {
      // prevent I-bar on drag
      //d3.event.preventDefault();

      // because :active only works in WebKit?
      svg.classed('active', true);

      node = {id: id, reflexive: true};
      node.x = 1;
      node.y = 1;
      console.log(node);
      nodes.push(node);

      restart();
      return node.id;
    }
    

    function novaAresta(vertice_1 , vertice_2){
      if(vertice_1 != null && vertice_2 != null && !isNaN(vertice_1) && !isNaN(vertice_2)){
        links.push({source: nodes[vertice_1], target: nodes[vertice_2], left: true, right: true });
        restart();
        return {1: vertice_1 ,2: vertice_2};
      }        
    }
    function verticeAleatorio() {
      return Math.floor(Math.random() * (nodes.length+1 - 0) + 0);
    }
    function superSnakeEatsAll(){
      controle.superSnakeInterval =
      setInterval(function(){
        //novaAresta(lastNodeId,novoVertice());
        //novaAresta(verticeAleatorio(),novoVertice());
        if(lastNodeId+1 < controle.tam)
          novoVertice();
        else if(links.length-1 < controle.tam)          
          console.log(novaAresta(nodes[verticeAleatorio()].id,nodes[verticeAleatorio()].id));
        else
          clearInterval(controle.superSnakeInterval);
        console.log(links.length);
      },250);
    }

    function limpaMatriz(){
      for(i=0;i<10;i++){
        for(j=0;j<10;j++){
            $('#'+i+''+j).removeClass();
            $('#'+i+''+j).html('0');
            //$('#'+i+''+j).attr('onclick',"if(this,innerHTML=='1') this.innerHTML='0'; else if(this,innerHTML=='0') this.innerHTML='1';");
            $('#'+i+''+j).attr('onclick',"changeState("+i+","+j+")");
        }
      }
    }

    function changeState(i,j){
      let cell = $('#'+i+''+j);
      let cell2 = $('#'+j+''+i);

      if( cell.html() == '0'){
        cell.html('1');
        cell2.html('1');
      }else if(cell.html() == '1'){
        cell.html('0');
        cell2.html('0');
      }
    }

    function atualizaMatriz(){
      controle.tam = $('#numero-matriz').val();
      
      
      //for(i=1;i<=10;i++)
      //  $('#'+i+''+i).addClass('teal');
    

      limpaMatriz();
      diagonalPrincipal(controle.tam);
      for(i=0;i<10;i++){
        for(j=0;j<10;j++){
          if(i>controle.tam || j>controle.tam) {
            $('#'+i+''+j).addClass('black');
            $('#'+i+''+j).html('');
          }
        }
      }
        

    }

    function diagonalPrincipal(tam){
      for(i=0;i<=tam;i++){          
            $('#'+i+''+i).removeClass();
            $('#'+i+''+i).html('0');
            $('#'+i+''+i).addClass('teal');
            $('#'+i+''+i).attr('onclick','');
      }
    }

    function next(){
      //console.log('next');
      //algo();

      if(controle.j== -1 && controle.i== 0){
        for(i=1;i<=controle.tam;i++){
          novoVertice();
          restart();
        }
      }
      //algo();

      //if(controle.j==controle.tam && controle.i== controle.tam) return;

      algo(false);

      controle.j++;
      if(controle.j>controle.tam){
        //controle.i++;
        //controle.j=0;
       // clearInterval(controle.intervalLoop);
        console.log('limp intervalo');
        algo(true);
        return;
      }

      if(controle.j==controle.tam && controle.i== controle.tam){
        //clearInterval(controle.intervalLoop);
        console.log('limp intervalo');
      }
      console.log(controle.i,controle.j);
      $('#'+controle.i+''+controle.j).removeClass();
      $('#'+controle.i+''+controle.j).addClass('yellow');

      //console.log(controle.i +','+controle.j+':'+ $('#'+controle.i+''+controle.j).html());
      
    }

    function algo(endOfLine){
      //next();
      //controle.count++;
      //console.log('count: '+controle.count+' size:'+controle.tam*controle.tam);
      if(controle.count > 1){
        console.log('BRAAAAAAAAKE!');
        pause();
      }
      if(controle.i == 0 && controle.j ==0) controle.count++;

      console.log('algo',controle.i,controle.j);



      if(endOfLine){
        let index = controle.v.indexOf(controle.i);
        controle.j = controle.i;
        controle.i = controle.pre[index];
      }else{
        if($('#'+controle.i+''+controle.j).html()=='1'){
          //let aux = controle.i;
          if(controle.v.indexOf(controle.j) == -1){
            controle.v.push(controle.j);
            controle.pre.push(controle.i);
            //novoVerticeId(controle.j);
            novaAresta(controle.i,controle.j);
            controle.i = controle.j;
            controle.j = -1;
          }
          
        }
      }
      
    }

   
    function restartAll(){

      clearInterval(controle.superSnakeInterval);

      controle.i = 1;
      controle.j = 0;
      /*while(nodes.length > 1){
        nodes.pop();
        restart();
      }*/
      while(nodes.length > 1){
        let last = nodes[nodes.length -1];
        nodes.splice(nodes.indexOf(last), 1);
        spliceLinksForNode(last);
        restart();
      }
        

      //nodes.push({id: 0, reflexive: true});
      //nodes.push({id: 1, reflexive: true});
      //nodes.push({id: 2, reflexive: true});
      /*
      while(links.length > 0){
        links.pop();
        restart();
      }*/
      //links.push({source: nodes[0], target: nodes[1], left: true, right: true });
      //links.push({source: nodes[1], target: nodes[2], left: true, right: true });
      
      //lastNodeId = 2;
      //lastNodeId = 1;

      restart();

    };

    
    function play(){
        controle.intervalLoop = setInterval(next,250);
    }

    function pause(){
        clearInterval(controle.intervalLoop);
    }


    atualizaMatriz();
    </script>


</html>
